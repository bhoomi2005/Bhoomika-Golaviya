<link href="https://fonts.googleapis.com/css2?family=Lustria&display=swap" rel="stylesheet">
{{ 'custom-gallery-css.css' | asset_url | stylesheet_tag }}
{{ 'quick-add.css' | asset_url | stylesheet_tag }}
<script src="{{ 'quick-add.js' | asset_url }}" defer="defer"></script>

<div class="custom-container custom-page-gallery-wrapper section-{{ section.id }}">
    {%- if section.settings.title != blank -%}
        <div class="section-title">{{ section.settings.title }}</div>
    {%- endif -%}
    {%- if section.blocks.size > 0 -%}
        <div class="custom-page-gallery-blocks">
            {%- for block in section.blocks -%}
                <div class="custom-page-gallery-block block-{{ block.id }}">
                    <div class="custom-page-gallery-block-image">
                        {%- if block.settings.image != blank -%}
                            <img srcset="{{ block.settings.image | img_url: 'master' }}" loading="lazy" alt="">
                        {%- elsif block.settings.related_product != blank -%}
                            <img srcset="{{ block.settings.related_product.featured_image | img_url: 'master' }}" loading="lazy" alt="">
                        {%- endif -%}
                        {%- if block.settings.related_product != blank -%}
                            {% assign product = block.settings.related_product %}
                            <modal-opener data-modal="#QuickAdd-{{ product.id }}">
                                <button
                                    id="form-{{ product.id }}-submit"
                                    class="quick-add__submit product-popup-trigger"
                                    aria-haspopup="dialog"
                                    data-product-url="{{ product.url }}?view=custom-add"
                                  >
                                    <svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <circle cx="11" cy="11" r="11" fill="#F8F8F8" fill-opacity="0.9"/>
                                        <path d="M11.3457 7.04175V15.5033" stroke="black" stroke-width="1.5" stroke-linecap="square" stroke-linejoin="round"/>
                                        <path d="M7.11523 11.2725H15.5768" stroke="black" stroke-width="1.5" stroke-linecap="square" stroke-linejoin="round"/>
                                    </svg>
                                    <div class="loading__spinner hidden"></div>
                                </button>
                            </modal-opener>

                            <quick-add-modal id="QuickAdd-{{ product.id }}" class="quick-add-modal custom">
                                <div
                                  role="dialog"
                                  aria-modal="true"
                                  class="quick-add-modal__content global-settings-popup"
                                  tabindex="-1"
                                >
                                  <button
                                    id="ModalClose-{{ product.id }}"
                                    type="button"
                                    class="quick-add-modal__toggle"
                                    aria-label="{{ 'accessibility.close' | t }}"
                                  >
                                    <svg width="18" height="18" viewBox="0 0 18 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M5.0376 4.9436L13.5229 13.4289" stroke="black" stroke-width="1.5" stroke-linecap="square" stroke-linejoin="round"/>
                                        <path d="M5.0376 13.4285L13.5229 4.94319" stroke="black" stroke-width="1.5" stroke-linecap="square" stroke-linejoin="round"/>
                                    </svg>
                                  </button>
                                  <div id="QuickAddInfo-{{ product.id }}" class="quick-add-modal__content-info"></div>
                                </div>
                            </quick-add-modal>

                        {%- endif -%}
                        <style>
                            .block-{{ block.id }} .product-popup-trigger{ top: {{ block.settings.icon_position_h }}%; left: {{ block.settings.icon_position_v }}%; }
                        </style>
                    </div>
                </div>
            {%- endfor -%}
        </div>
    {%- endif -%}
    <style>
        .section-{{ section.id }}{ padding-top: {{ section.settings.padding_top }}px; padding_bottom: {{ section.settings.padding_bottom }}px; }
        .section-{{ section.id }} .custom-page-gallery-block-image img{ height: {{ section.settings.image_height }}px; }
        @media screen and (max-width: 767px){
            .section-{{ section.id }}{ padding-top: {{ section.settings.padding_top_m }}px; padding_bottom: {{ section.settings.padding_bottom_m }}px; }
            .section-{{ section.id }} .custom-page-gallery-block-image img{ height: {{ section.settings.image_height_m }}px; }
        }
    </style>
</div>

{% schema %}
{
  "name": "Custom page grid",
  "tag": "section",
  "class": "section",
  "settings": [
    {
        "type": "text",
        "id": "title",
        "label": "Title"
    },
    {
        "type": "header",
        "content": "t:sections.all.padding.section_padding_heading"
    },
    {
        "type": "range",
        "id": "padding_top",
        "min": 0,
        "max": 100,
        "step": 2,
        "unit": "px",
        "label": "Padding top(Desktop)",
        "default": 40
    },
    {
        "type": "range",
        "id": "padding_bottom",
        "min": 0,
        "max": 100,
        "step": 2,
        "unit": "px",
        "label": "Padding bottom(Desktop)",
        "default": 52
    },
    {
        "type": "range",
        "id": "padding_top_m",
        "min": 0,
        "max": 100,
        "step": 2,
        "unit": "px",
        "label": "Padding top(Mobile)",
        "default": 40
    },
    {
        "type": "range",
        "id": "padding_bottom_m",
        "min": 0,
        "max": 100,
        "step": 2,
        "unit": "px",
        "label": "Padding bottom(Mobile)",
        "default": 52
    },
    {
        "type": "range",
        "id": "image_height",
        "label": "Image height(Desktop)",
        "min": 300,
        "max": 600,
        "step": 5,
        "unit": "px",
        "default": 445
    },
    {
        "type": "range",
        "id": "image_height_m",
        "label": "Image height(Mobile)",
        "min": 100,
        "max": 400,
        "step": 5,
        "unit": "px",
        "default": 185
    }
  ],
  "blocks": [
    {
        "type": "image",
        "name": "Image",
        "settings": [
            {
                "type": "image_picker",
                "id": "image",
                "label": "Image"
            },
            {
                "type": "product",
                "id": "related_product",
                "label": "Related product"
            },
            {
                "type": "header",
                "content": "Icon position(Desktop)"
            },
            {
                "type": "range",
                "id": "icon_position_h",
                "label": "Horizontal position of icon",
                "min": 0,
                "max": 100,
                "step": 1,
                "unit": "%",
                "default": 50
            },
            {
                "type": "range",
                "id": "icon_position_v",
                "label": "Vertical position of icon",
                "min": 0,
                "max": 100,
                "step": 1,
                "unit": "%",
                "default": 50
            },
            {
                "type": "header",
                "content": "Icon position(Mobile)"
            },
            {
                "type": "range",
                "id": "icon_position_h_m",
                "label": "Horizontal position of icon",
                "min": 0,
                "max": 100,
                "step": 1,
                "unit": "%",
                "default": 50
            },
            {
                "type": "range",
                "id": "icon_position_v_m",
                "label": "Vertical position of icon",
                "min": 0,
                "max": 100,
                "step": 1,
                "unit": "%",
                "default": 50
            }
        ]
    }
  ],
  "presets": [
    {
      "name": "Custom page grid"
    }
  ]
}
{% endschema %}
